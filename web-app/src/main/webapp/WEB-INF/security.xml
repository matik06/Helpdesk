
<beans:beans xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/security
    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <global-method-security secured-annotations="enabled" jsr250-annotations="enabled" pre-post-annotations="enabled" />    
    
    <http auto-config="true" use-expressions="true" once-per-request="false" access-denied-page="/accessDenied.xhtml">        
        <form-login login-page="/login.xhtml" default-target-url="/helpdesk-users"/>        
        <logout logout-url="/logout" logout-success-url="/login.xhtml"/>
        
        <intercept-url pattern="/**" />
        <intercept-url pattern="/customers/**" access="hasRole('ROLE_ADMIN')" />
        
    
<!--        <intercept-url pattern="/**" access="ROLE_USER"/>-->
<!--        <intercept-url pattern="/helpdesk" access="IS_AUTHENTICATED_ANONYMOUSLY"/>-->
<!--        <intercept-url pattern="/login.jsp*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <form-login login-page='/' />-->
<!--        <form-login login-page='/login.htm' default-target-url='/helpdesk-users' always-use-default-target='true' />-->
<!--        <logout logout-url="/" />-->
        
        <!-- redirect to https if http was used -->
        <!-- <intercept-url pattern="/secure/**" access="ROLE_USER" requires-channel="https"/> -->
        
        
        <!-- Detecting timeout -->
<!--        <logout delete-cookies="JSESSIONID" />
        <session-management invalid-session-url="/invalidSession.htm" />-->
        
        <!--   -->
        <!--   -->
        <!--   -->
        <!--   -->
    </http>
        
    <authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="userDetailsService">
            
<!--            <password-encoder hash="">
                <salt-source user-property="username">
            </password-encoder>-->
            
<!--            <user-service>                 
                <user name="user" password="user" authorities="ROLE_USER" />
                <user name="admin" password="admin" authorities="ROLE_USER, ROLE_ADMIN" />
                <user name="jimi" password="jimispassword" authorities="ROLE_USER, ROLE_ADMIN" />
                <user name="bob" password="bobspassword" authorities="ROLE_USER" />   
                <user name="jimi2" password="d7e6351eaa13189a5a3641bab846c8e8c69ba39f" authorities="ROLE_USER, ROLE_ADMIN" />
                <user name="bob2" password="4e7421b1b8765d8f9406d87e7cc6aa784c4ab97f" authorities="ROLE_USER" />
            </user-service>-->
        </authentication-provider>
    </authentication-manager>
    
            
</beans:beans>